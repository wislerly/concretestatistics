<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--映射文件-->
<mapper namespace="com.nmz.concretestatistics.mapper.BusinessDetialsMapper">

    <sql id="clowns"> business_name
    , pouring_position, pouring_method, quantities, number_of_vehicles,strength_grade, unit_price_of_concrete, freight, total_amount, remarks, pour_price, strength_price</sql>

    <insert id="addBusiness" parameterType="com.nmz.concretestatistics.povo.BusinessDetials">
        insert into business_detials (<include refid="clowns"></include>,business_date)
        values (#{business_name}, #{pouring_position}, #{pouring_method}, #{quantities}, #{number_of_vehicles},
        #{strength_grade}, #{unit_price_of_concrete}, #{freight}, #{total_amount}, #{remarks},#{pour_price},#{strength_price}, #{business_date})
    </insert>
    <select id="queryAll" resultType="com.nmz.concretestatistics.povo.BusinessDetials">
        select <include refid="clowns"></include>,
        date_format(business_date, "%Y-%m-%d") business_date
        from business_detials
        <where>
            <if test="business_name != null and business_name != ''">
                and business_name = #{business_name}
            </if>
            <if test="business_date != null and business_date != ''">
                and business_date = #{business_date}
            </if>
        </where>
    </select>
    <select id="getIfFloor" resultType="java.lang.Integer">
        select count(*) from business_detials where business_name = #{busName} and business_date = #{busDate} and pouring_method = #{pouring_method} and quantities <![CDATA[>]]> 80
    </select>
</mapper>